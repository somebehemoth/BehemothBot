const Discord = require('discord.js');
const { prefix, token } = require('./config.json');
const axios = require('axios');
const cheerio = require('cheerio');

const client = new Discord.Client();

client.once('ready', () => {
	console.log('Ready! BehemothBot is online.');
});

client.on('message', message => {
	console.log(message.content);
	if (!message.content.startsWith(prefix) || message.author.bot) return;

	const args = message.content.slice(prefix.length).trim().split(/ +/);
	const command = args.shift().toLowerCase();

	if (command === 'ping') {
		message.channel.send('pong')
	}
	else if (command === 'calljs') {
		message.channel.send('Discord.js and BehemothBot.js and config.json are all up and working')
	}
	else if (command === 'meme') {
		const getPostTitles = async () => {
		try {
		const { data } = await axios.get(
			'https://old.reddit.com/r/dankmemes/'
		);
		const $ = cheerio.load(data);
		const postTitles = [];
		$('div > p.title > a').each((_idx, el) => {
			const postTitle = $(el).text()
			postTitles.push(postTitle)
		});
	const link = $(".product-card__img-link-overlay").each((index, el) => {
    	const item = $(el).attr("href")
    	data[index].link = item
})
	const img = $("img").attr("src")
	message.channel.send(img)

		return postTitles;
	} catch (error) {
		throw error;
	}
};
getPostTitles()
.then((postTitles) => message.channel.send(postTitles));
    }
	// other commands...
});

client.login(token)
